# Практическое занятие 6

## Приближенное решение уравнений методом Ньютона

Рассмотрим уранение вида

$$ f(x)=0 $$

где $f: [a;b] \to \mathbb{R}$ - некоторая, вообще говоря, не линейная функция.

Ранее такого рода уравнения мы решали методом деления отрезка пополам. Рассмотрим теперь ещё один метод, называемый методом Ньютона или методом касательных.

Согласно методу Ньютона получить приближенное решение рассматриваемого уравнения можно воспользовавшись следующей рекуррентной формулой:

$$ x_{n+1}=x_n-\frac{f(x_n)}{f^\prime(x_n)} $$

где $n=0,1,2,3,..., \ \ \ x_0$ - заданное начальное приближение.

Вычисления по этой формуле следует прекращать при  достижении условия

$$ |x_{n+1}-x_n|\le \varepsilon $$

где  $\varepsilon>0$ - заданная величина, определяющая погрешность вычислений.

Кроме того, при неудачном выборе начального приближения $x_0$ вычисляемая последовательность $x_n$ может не иметь предела (не сходиться к искомому корню)

Поэтому, чтобы избежать возможных зацикливаний, число итераций метода должно быть ограничено некоторой величиной (обычно не слишком большой).

## Вывод формулы метода Ньютона

Пусть $x_0$ - это некотрое начальное приближение неизвестного нам точного решения $x^*$ рассматриваемого уравнения. И пусть функция $f(x)$ дважды дифференцируемая в окрестности значения, которое мы будем считать заданным начальным приближением. Тогда воспользовавшись формулой Тейлора в малой окрестности этой точки $x_0$, получим:

$$ f(x_0+\Delta)=f(x_0)+f^\prime(x_0)\Delta+o(\Delta) $$

где $\Delta=x-x_0$, т.е.

$$ f(x)=f(x_0)+f^\prime(x_0)(x-x_0)+o(\Delta) $$

Если отбросить $o(\Delta)$, т.е. заменить точное равенство приближеным, то получим линейное (относительно $x$) уравнение

$$ f(x)\approx f(x_0)+f^\prime(x_0)(x-x_0)=0 $$

решая которое, найдем следующее приближение к решению исходного уравнения

$$ x_1=x_0-\frac{f(x_0)}{f^\prime(x_0)} $$

Далее, если значение $x_1$ оказалось ещё ближе к искомому корню, то процедуру получения более точного приближения можно повторить. И так далее, по следующей схеме

$$ x_{n+1}=x_n-\frac{f(x_n)}{f^\prime(x_n)} $$

где $n=0,1,2,3,...$.

**Замечание.** Рассмотренную схему вычислений можно проиллюстрировать [геометрически](https://ru.wikipedia.org/wiki/Метод_Ньютона#Геометрическая_интерпретация). Это объесняет причину, по которой метод Ньютона называют также методом касательных.

Полученную рекуррентную формулу также можно лего получить из чисто геометрических соображений.

## Обобщение метода Ньютона на случай комплексной переменной

Рассмотрим уравнение $f(z)=0$, где $f: \mathbb{C} \to \mathbb{C}$, - некоторая дифференциируемая функция комплесного переменного.

Тогда оказывается, что полученная ранее рекуррентная формула будет применима и в этом случае в неизменном виде.

При этом определение производной в случае комплексной переменной внешне совпадает с таковым для функции вещественной переменной:

$$ f'(z) = \lim_{\abs{\Delta z} \to 0} \frac{f(z+\Delta z)-f(z)}{\Delta z} $$

. Из этог, в частности, следует, что $(z^n)'=nz^{n-1}$. Таким образом, многочлены, как функции комплексной переменной, можно дифферецировать по привычным правилам.

Ввиду сказанного, метод Ньютона можно использовать, например, для поиска комплексных кореней многочленов.

**Замечание.** Для вычисления корней уравнений для Julia имеется специальный пакет [Roots.jl]](https://docs.juliahub.com/Roots/o0Xsi/1.0.8/).

## Задания для программирования

1. Написать функцию, реализующую метод Ньютона

**Описание функции:**

```julia
"""
function newton(r::Function, x_0; epsilon = 1e-8, max_num_iter = 20)

Ищет корень уравнения f(x)=0
-- r(x)= -f(x)/f'(x)
-- x_0 - начальное приближение
-- epsilon > 0 - пераметр, определяющий точность вычислений
(критерй останова: |x - x_prev| = |r(x_prev)| <= epsilon)
-- max_num_iter - максимальное число итераций
"""
```

**Решение:**

```julia
function newton(r::Function, x; epsilon = 1e-8, max_num_iter = 20)
    num_iter = 0
    r_x = r(x)
    while num_iter < max_num_iter && abs(r_x) > epsilon
        x += r_x
        r_x = r(x)
        num_iter += 1
    end

    if abs(r_x) <= epsilon
        return x
    else
        return NaN
    end
end
```

2. С помощью функции newton решить уравнение cos(x)=x

**Решение.**
"""

f(x)=cos(x)-x

f'(x)=-sin(x)-1

r(x) = -f(x)/f'(x) = (cos(x)-x)/(sin(x)+1)

newton(x -> (cos(x)-x)/(sin(x)+1), 0.5)

"""

3. С помощью функции newton и написанной ранее функции polyval, возвращающей значение многочлена (заданного вектором коэффициентов) и его производной в заданной точке, написать функцию, возвращающее приближенное значение комплексого корня многочлена, ближайшего к заданной точке комплексой плоскости.

4. Написать функцию, по заданному начальному приближению вычисляющую приближенное значение корня уравнения $f(x)=0$ в случае, когда нет практической возможности получит выражение для $f'(x)$, и вместо этого приходится пользоваться приближенной формулой:

$$f'(x) \approx = \frac{f(x+h)-f(x)}{h}$$

где, например, можно положить $h = 1e-8$.

5. Воспользовавшись результатами пункта 4, визуализировать так называемую проблему Кэлли, состоящую в следующем.

Как известно уравнение
$$ z^3 - 1 = 0 $$
имеет 3 комплексных корня. Требуется раскрасить комплексную полскость (некоторую ее квадратную часть, содержащую круг единичного радиуса, на котором лежат корни уравнения) на три части, каждая из которых есть "бассейн притяжения" одного из трех корней уравнения.

Для этого можно брать наугад какую-либо точку из заданного квадрата (содержащего единичный круг), итерировать с этим началным значением по методу Ньютона, и если в результате найденное результирующее значение окажется в малой окрестности k-го корня уравнения (k=0,1,2), то данная начальная точка должна быть окрашена в соответствующий цвет.

Для построения графиков можно воспользоваться графическим пакетом [Plots.jl](https://docs.juliaplots.org/latest/tutorial/)
